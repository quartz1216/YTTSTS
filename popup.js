const translations = {
  ja: {
    languageSetting: "ğŸŒ è¨€èªè¨­å®š",
    narratorSetting: "ğŸ™ï¸ ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼è¨­å®š",
    saveButton: "ğŸ’¾ ä¿å­˜",
    saved: "âœ… è¨­å®šå®Œäº†",
    reloadMessage: "è¨­å®šã¯ãƒªãƒ­ãƒ¼ãƒ‰å¾Œã«åæ˜ ã•ã‚Œã¾ã™ã€‚",
  },
  en: {
    languageSetting: "ğŸŒ Language Settings",
    narratorSetting: "ğŸ™ï¸ Narrator Settings",
    saveButton: "ğŸ’¾ Save",
    saved: "âœ… Settings Saved",
    reloadMessage: "Settings will apply after reload.",
  },
  fr: {
    languageSetting: "ğŸŒ ParamÃ¨tres de langue",
    narratorSetting: "ğŸ™ï¸ ParamÃ¨tres du narrateur",
    saveButton: "ğŸ’¾ Sauvegarder",
    saved: "âœ… ParamÃ¨tres enregistrÃ©s",
    reloadMessage: "Les paramÃ¨tres seront appliquÃ©s aprÃ¨s le rechargement.",
  },
  de: {
    languageSetting: "ğŸŒ Spracheinstellungen",
    narratorSetting: "ğŸ™ï¸ ErzÃ¤hler-Einstellungen",
    saveButton: "ğŸ’¾ Speichern",
    saved: "âœ… Einstellungen gespeichert",
    reloadMessage: "Einstellungen werden nach dem Neuladen Ã¼bernommen.",
  },
  "zh-CN": {
    languageSetting: "ğŸŒ è¯­è¨€è®¾ç½® (ç®€ä½“)",
    narratorSetting: "ğŸ™ï¸ æ—ç™½è®¾ç½®",
    saveButton: "ğŸ’¾ ä¿å­˜",
    saved: "âœ… è®¾ç½®å·²ä¿å­˜",
    reloadMessage: "è®¾ç½®å°†åœ¨é‡æ–°åŠ è½½åç”Ÿæ•ˆã€‚",
  },
  "zh-TW": {
    languageSetting: "ğŸŒ èªè¨€è¨­ç½® (ç¹é«”)",
    narratorSetting: "ğŸ™ï¸ æ—ç™½è¨­ç½®",
    saveButton: "ğŸ’¾ ä¿å­˜",
    saved: "âœ… è¨­ç½®å·²ä¿å­˜",
    reloadMessage: "è¨­ç½®å°‡åœ¨é‡æ–°åŠ è¼‰å¾Œç”Ÿæ•ˆã€‚",
  },
  ko: {
    languageSetting: "ğŸŒ ì–¸ì–´ ì„¤ì •",
    narratorSetting: "ğŸ™ï¸ ë‚´ë ˆì´í„° ì„¤ì •",
    saveButton: "ğŸ’¾ ì €ì¥",
    saved: "âœ… ì„¤ì • ì™„ë£Œ",
    reloadMessage: "ì„¤ì •ì€ ìƒˆë¡œê³ ì¹¨ í›„ì— ì ìš©ë©ë‹ˆë‹¤.",
  },
  es: {
    languageSetting: "ğŸŒ ConfiguraciÃ³n de idioma",
    narratorSetting: "ğŸ™ï¸ ConfiguraciÃ³n de narrador",
    saveButton: "ğŸ’¾ Guardar",
    saved: "âœ… ConfiguraciÃ³n guardada",
    reloadMessage: "La configuraciÃ³n se aplicarÃ¡ despuÃ©s de recargar.",
  },
  pt: {
    languageSetting: "ğŸŒ ConfiguraÃ§Ã£o de idioma",
    narratorSetting: "ğŸ™ï¸ ConfiguraÃ§Ã£o do narrador",
    saveButton: "ğŸ’¾ Salvar",
    saved: "âœ… ConfiguraÃ§Ã£o salva",
    reloadMessage: "As configuraÃ§Ãµes serÃ£o aplicadas apÃ³s o recarregamento.",
  },
  ru: {
    languageSetting: "ğŸŒ ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ ÑĞ·Ñ‹ĞºĞ°",
    narratorSetting: "ğŸ™ï¸ ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ´Ğ¸ĞºÑ‚Ğ¾Ñ€Ğ°",
    saveButton: "ğŸ’¾ Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ",
    saved: "âœ… ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ñ‹",
    reloadMessage: "ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ±ÑƒĞ´ÑƒÑ‚ Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½ĞµĞ½Ñ‹ Ğ¿Ğ¾ÑĞ»Ğµ Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸.",
  },
  it: {
    languageSetting: "ğŸŒ Impostazioni lingua",
    narratorSetting: "ğŸ™ï¸ Impostazioni del narratore",
    saveButton: "ğŸ’¾ Salva",
    saved: "âœ… Impostazioni salvate",
    reloadMessage: "Le impostazioni verranno applicate dopo il riavvio.",
  },
  nl: {
    languageSetting: "ğŸŒ Taalinstellingen",
    narratorSetting: "ğŸ™ï¸ Instellingen voor verteller",
    saveButton: "ğŸ’¾ Opslaan",
    saved: "âœ… Instellingen opgeslagen",
    reloadMessage: "Instellingen worden toegepast na het herladen.",
  },
  tr: {
    languageSetting: "ğŸŒ Dil AyarlarÄ±",
    narratorSetting: "ğŸ™ï¸ AnlatÄ±cÄ± AyarlarÄ±",
    saveButton: "ğŸ’¾ Kaydet",
    saved: "âœ… Ayarlar Kaydedildi",
    reloadMessage: "Ayarlar yeniden yÃ¼klendikten sonra uygulanacaktÄ±r.",
  },
  ar: {
    languageSetting: "ğŸŒ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù„ØºØ©",
    narratorSetting: "ğŸ™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø±Ø§ÙˆÙŠ",
    saveButton: "ğŸ’¾ Ø­ÙØ¸",
    saved: "âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª",
    reloadMessage: "Ø³ÙŠØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ø¹Ø¯ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„.",
  },
  vi: {
    languageSetting: "ğŸŒ CÃ i Ä‘áº·t ngÃ´n ngá»¯",
    narratorSetting: "ğŸ™ï¸ CÃ i Ä‘áº·t ngÆ°á»i Ä‘á»c",
    saveButton: "ğŸ’¾ LÆ°u",
    saved: "âœ… ÄÃ£ lÆ°u cÃ i Ä‘áº·t",
    reloadMessage: "CÃ i Ä‘áº·t sáº½ Ä‘Æ°á»£c Ã¡p dá»¥ng sau khi táº£i láº¡i.",
  },
  hi: {
    languageSetting: "ğŸŒ à¤­à¤¾à¤·à¤¾ à¤¸à¥‡à¤Ÿà¤¿à¤‚à¤—",
    narratorSetting: "ğŸ™ï¸ à¤•à¤¥à¤¾à¤µà¤¾à¤šà¤• à¤¸à¥‡à¤Ÿà¤¿à¤‚à¤—à¥à¤¸",
    saveButton: "ğŸ’¾ à¤¸à¤¹à¥‡à¤œà¥‡à¤‚",
    saved: "âœ… à¤¸à¥‡à¤Ÿà¤¿à¤‚à¤— à¤¸à¤¹à¥‡à¤œà¥€ à¤—à¤ˆ",
    reloadMessage: "à¤¸à¥‡à¤Ÿà¤¿à¤‚à¤— à¤ªà¥à¤¨à¤ƒ à¤²à¥‹à¤¡ à¤•à¤°à¤¨à¥‡ à¤•à¥‡ à¤¬à¤¾à¤¦ à¤²à¤¾à¤—à¥‚ à¤¹à¥‹à¤—à¥€à¥¤",
  },
  th: {
    languageSetting: "ğŸŒ à¸à¸²à¸£à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¸ à¸²à¸©à¸²",
    narratorSetting: "ğŸ™ï¸ à¸à¸²à¸£à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¸œà¸¹à¹‰à¸šà¸£à¸£à¸¢à¸²à¸¢",
    saveButton: "ğŸ’¾ à¸šà¸±à¸™à¸—à¸¶à¸",
    saved: "âœ… à¸à¸²à¸£à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¸–à¸¹à¸à¸šà¸±à¸™à¸—à¸¶à¸à¹à¸¥à¹‰à¸§",
    reloadMessage: "à¸à¸²à¸£à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¸ˆà¸°à¸–à¸¹à¸à¸™à¸³à¹„à¸›à¹ƒà¸Šà¹‰à¸«à¸¥à¸±à¸‡à¸ˆà¸²à¸à¸£à¸µà¹‚à¸«à¸¥à¸”.",
  },
  id: {
    languageSetting: "ğŸŒ Pengaturan Bahasa",
    narratorSetting: "ğŸ™ï¸ Pengaturan Narator",
    saveButton: "ğŸ’¾ Simpan",
    saved: "âœ… Pengaturan Disimpan",
    reloadMessage: "Pengaturan akan diterapkan setelah dimuat ulang.",
  },
  sv: {
    languageSetting: "ğŸŒ SprÃ¥kinstÃ¤llningar",
    narratorSetting: "ğŸ™ï¸ BerÃ¤ttarinstÃ¤llningar",
    saveButton: "ğŸ’¾ Spara",
    saved: "âœ… InstÃ¤llningar sparade",
    reloadMessage: "InstÃ¤llningar tillÃ¤mpas efter omladdning.",
  },
  pl: {
    languageSetting: "ğŸŒ Ustawienia jÄ™zyka",
    narratorSetting: "ğŸ™ï¸ Ustawienia lektora",
    saveButton: "ğŸ’¾ Zapisz",
    saved: "âœ… Ustawienia zapisane",
    reloadMessage: "Ustawienia zostanÄ… zastosowane po przeÅ‚adowaniu.",
  },
};



// ğŸŒ UIã®ãƒ†ã‚­ã‚¹ãƒˆã‚’æ›´æ–°ã™ã‚‹é–¢æ•°
function updateUIText(languageCode) {
  const translation = translations[languageCode] || translations["en"];

  document.getElementById("languagetitle").textContent = translation.languageSetting;
  document.getElementById("voicetitle").textContent = translation.narratorSetting;
  document.getElementById("saveButton").textContent = translation.saveButton;
  document.getElementById("statusMessage").textContent = ""; // åˆæœŸåŒ–
}



document.addEventListener("DOMContentLoaded", () => {
  const languageSelect = document.getElementById("languageSelect");
  const voiceSelect = document.getElementById("voiceSelect");
  const saveButton = document.getElementById("saveButton");
  const statusMessage = document.getElementById("statusMessage");

  let allVoices = [];

  // ğŸ™ï¸ åˆ©ç”¨å¯èƒ½ãªéŸ³å£°ã‚¨ãƒ³ã‚¸ãƒ³ã‚’å–å¾—
  function populateVoiceList(selectedLanguage) {
    allVoices = speechSynthesis.getVoices();
    voiceSelect.innerHTML = ""; // åˆæœŸåŒ–

    // ğŸ¯ è¨€èªã”ã¨ã«ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
    const filteredVoices = allVoices.filter((voice) => voice.lang.startsWith(selectedLanguage));

    filteredVoices.forEach((voice) => {
      const option = document.createElement("option");
      option.value = voice.name;
      option.textContent = `${voice.name} (${voice.lang})`;
      voiceSelect.appendChild(option);
    });

    // ğŸ”„ å‰å›ã®è¨­å®šã‚’å¾©å…ƒ
    chrome.storage.sync.get(["selectedVoice", "selectedLanguage"], (data) => {
      const language = data.selectedLanguage || "en";
      languageSelect.value = language;
      updateUIText(language); // ğŸŒ UIãƒ†ã‚­ã‚¹ãƒˆã‚’æ›´æ–°

      if (data.selectedVoice) {
        voiceSelect.value = data.selectedVoice;
      }
    });
  }

  // ğŸ”„ è¨€èªå¤‰æ›´æ™‚ã«ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼ãƒªã‚¹ãƒˆã‚’æ›´æ–° + UIæ›´æ–°
  languageSelect.addEventListener("change", () => {
    const selectedLanguage = languageSelect.value;
    chrome.storage.sync.set({ selectedLanguage }, () => {
      console.log(`ğŸŒ è¨€èªè¨­å®šãŒå¤‰æ›´ã•ã‚Œã¾ã—ãŸ: ${selectedLanguage}`);
      populateVoiceList(selectedLanguage); // ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼ãƒªã‚¹ãƒˆã‚’æ›´æ–°
      updateUIText(selectedLanguage); // UIã®ãƒ†ã‚­ã‚¹ãƒˆã‚‚æ›´æ–°
      resetSaveButton(); // ãƒœã‚¿ãƒ³ã‚’å…ƒã«æˆ»ã™
    });
  });
  voiceSelect.addEventListener("change",()=>{
    resetSaveButton()
  })

  // ğŸ”„ éŸ³å£°ãƒªã‚¹ãƒˆã®åˆæœŸåŒ–
  speechSynthesis.onvoiceschanged = () => {
    chrome.storage.sync.get("selectedLanguage", (data) => {
      const savedLanguage = data.selectedLanguage || navigator.language.split("-")[0] || "en";
      languageSelect.value = savedLanguage;
      updateUIText(savedLanguage); // ğŸŒ UIãƒ†ã‚­ã‚¹ãƒˆã‚’åˆæœŸåŒ–
      populateVoiceList(savedLanguage);
    });
  };

  // ğŸ’¾ è¨­å®šã‚’ä¿å­˜
  saveButton.addEventListener("click", () => {
    const selectedVoice = voiceSelect.value;
    const selectedLanguage = languageSelect.value;

    chrome.storage.sync.set({ selectedVoice, selectedLanguage }, () => {
      console.log(`âœ… è¨­å®šãŒä¿å­˜ã•ã‚Œã¾ã—ãŸ: ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼ - ${selectedVoice}, è¨€èª - ${selectedLanguage}`);

      // ğŸ”’ ä¿å­˜ãƒœã‚¿ãƒ³ã‚’ã‚°ãƒ¬ãƒ¼ã‚¢ã‚¦ãƒˆ
      saveButton.textContent = translations[selectedLanguage].saved;
      saveButton.disabled = true;
      saveButton.style.backgroundColor = "#ccc";

      // ğŸ“¢ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
      statusMessage.textContent = translations[selectedLanguage].reloadMessage;
    });
  });

  // ğŸ”„ è¨­å®šãŒå¤‰æ›´ã•ã‚ŒãŸã¨ãã«ãƒœã‚¿ãƒ³ã‚’å…ƒã«æˆ»ã™
  function resetSaveButton() {
    const selectedLanguage = languageSelect.value;
    saveButton.disabled = false;
    saveButton.textContent = translations[selectedLanguage].saveButton;
    saveButton.style.backgroundColor = "";
    statusMessage.textContent = ""; // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãƒªã‚»ãƒƒãƒˆ
  }
});
